async function loadAgentDetails() {
    try {
        const response = await fetch('https://nt8rgr84ce.execute-api.us-east-1.amazonaws.com/develop', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            },
            mode: 'cors'
        });

        if (!response.ok) {
            throw new Error('Network response was not ok');
        }

        const agents = await response.json();
        console.log("API Response:", agents);  // Debugging log

        // Check if response is an array
        if (!Array.isArray(agents)) {
            throw new Error("Unexpected API response format, expected an array");
        }

        const tableBody = document.getElementById('agentTableBody');
        tableBody.innerHTML = '';

        agents.forEach(agent => {
            const row = `
                <tr>
                    <td>${agent.username || 'N/A'}</td>
                    <td>${agent.first_name || 'N/A'}</td>
                    <td>${agent.last_name || 'N/A'}</td>
                    <td>${agent.extension || 'N/A'}</td>
                    <td>
                        <button onclick="editAgent('${agent.username || ''}')">Edit</button>
                        <button onclick="deleteAgent('${agent.username || ''}')">Delete</button>
                    </td>
                </tr>
            `;
            tableBody.innerHTML += row;
        });
    } catch (error) {
        console.error('Error fetching agent details:', error);
        alert('Failed to load agent details');
    }
}
